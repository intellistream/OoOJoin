1. fix the throughput calculation bugs
